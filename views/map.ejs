<!DOCTYPE html>

<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Mapa interactivo</title>
  <style>
    .tooltip-box:hover title {
      display: block;
    }
    svg {
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Mapa de la nave</h1>
  <p>Bienvenido, <%= usuario.nombre %></p>

  <svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
    <image xlink:href="<%= mapa.imagen_url %>" width="800" height="600" />
    <% puntos.forEach(p => { %>
      <g id="punto-<%= p.id %>" class="tooltip-box" aria-label="Punto <%= p.nombre %>">
        <rect x="<%= p.x %>" y="<%= p.y %>" width="<%= p.ancho %>" height="<%= p.alto %>" fill="yellow" />
        <title>Sin revisión</title>
      </g>
    <% }) %>
  </svg>
  <script type="module" src="/js/actualizarEstados.js"></script>
<h2>Últimas revisiones</h2>
<table border="1" cellpadding="6" cellspacing="0">
  <thead>
    <tr>
      <th>Punto</th>
      <th>Usuario</th>
      <th>Fecha y hora</th>
    </tr>
  </thead>
  <tbody>
    <% revisiones.forEach(r => { %>
      <tr>
        <td><%= r.punto %></td>
        <td><%= r.usuario || '—' %></td>
        <td><%= r.fecha_hora ? new Date(r.fecha_hora).toLocaleString('es-ES') : '—' %></td>
      </tr>
    <% }) %>
  </tbody>
</table>

</body>
</html>
